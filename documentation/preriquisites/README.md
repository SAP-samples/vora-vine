## Queries

Query 1 to 4 
- Creating the necessary tables.

    ```sql
   
   
    CREATE TABLE ADDRESSES (ADDRESSID VARCHAR(100), CITY VARCHAR(100), POSTALCODE VARCHAR(100), STREET VARCHAR(100), BUILDING VARCHAR(100), COUNTRY VARCHAR(100), REGION VARCHAR(100), ADDRESSTYPE VARCHAR(100), STARTDATE date, ENDDATE date, LATITUDE VARCHAR(100), LONGITUD VARCHAR(100)) STORE IN MEMORY;
    ALTER TABLE ADDRESSES ADD DATASOURCE PARQUET(HDFS('hdfs://hdfs:9000/user/vora/addresses.parquet'));
    Load Table ADDRESSES;

    CREATE TABLE BUSINESS_PARTNER (PARTNERID VARCHAR(100), PARTNERROLE  VARCHAR(100), EMAILADDRESS  VARCHAR(100), PHONENUMBER  VARCHAR(100), FAXNUMBER  VARCHAR(100), WEBADDRESS  VARCHAR(100), ADDRESSID  VARCHAR(100), COMPANYNAME  VARCHAR(100), LEGALFORM  VARCHAR(100), CREATEDBY_EMPLOYEEID  VARCHAR(100), CREATEDAT date, CHANGEDBY_EMPLOYEEID  VARCHAR(100), CHANGEDAT date, CURRENCY  VARCHAR(100)) STORE IN MEMORY;
    ALTER TABLE BUSINESS_PARTNER ADD DATASOURCE ORC(HDFS('hdfs://hdfs:9000/user/vora/businessPartner.orc'));
    Load Table BUSINESS_PARTNER;

    CREATE TABLE SO_HEADER (SALESORDERID varchar(100), CREATEDBY_EMPLOYEEID varchar(100), CREATEDAT date, CHANGEDBY_EMPLOYEEID varchar(100), CHANGEDAT date, NOTEID varchar(100), PARTNERID varchar(100), CURRENCY varchar(100), GROSSAMOUNT decimal(15,2), NETAMOUNT decimal(15,2), TAXAMOUNT decimal(15,2), LIFECYCLESTATUS varchar(100), BILLINGSTATUS varchar(100), DELIVERYSTATUS varchar(100)) Store ON DISK;
    ALTER TABLE SO_HEADER ADD DATASOURCE HDFS('hdfs://hdfs:9000/user/vora/soHeaderData.csv');
    LOAD TABLE SO_HEADER;

    CREATE TABLE SO_ITEM (SALESORDERID varchar(100), SALESORDERITEM varchar(100), PRODUCTID varchar(100), NOTEID varchar(100),  CURRENCY varchar(100), GROSSAMOUNT decimal(15,2), NETAMOUNT decimal(15,2), TAXAMOUNT decimal(15,2), ITEMATPSTATUS varchar(100), OPITEMPOS varchar(100), QUANTITY decimal(15,2), QUANTITYUNIT varchar(100), DELIVERYDATE date  ) Store IN MEMORY;
    ALTER TABLE SO_ITEM ADD DATASOURCE HDFS('hdfs://hdfs:9000/user/vora/soItemData.csv');
    LOAD TABLE SO_ITEM; 

    ```

Query 5
- Create view, ORDER_COUNT to get the number of items sold for each order

    ```sql
    CREATE VIEW ORDER_COUNT
    AS SELECT "VORA"."SO_ITEM"."SALESORDERID" , count("VORA"."SO_ITEM"."SALESORDERID") AS "NOOFITEMS"  
    FROM  "VORA"."SO_ITEM" 
    GROUP BY "VORA"."SO_ITEM"."SALESORDERID";
    ```

Query 6
- Create view, ORDER_DETAILS to get the important details of each order like details of the Business Partner (Customer), Address associated to the order, No. of items & Gross Amount per order, when the order was created, etc.

    ```sql
    CREATE VIEW ORDER_DETAILS
    AS SELECT "VORA"."ADDRESSES"."CITY" , "VORA"."ADDRESSES"."STREET" , "VORA"."ADDRESSES"."BUILDING" , "VORA"."ADDRESSES"."COUNTRY" , "VORA"."ADDRESSES"."REGION" , "VORA"."ADDRESSES"."LATITUDE" , "VORA"."ADDRESSES"."LONGITUD" , "VORA"."BUSINESS_PARTNER"."COMPANYNAME" , "VORA"."SO_HEADER"."CREATEDAT" , "VORA"."SO_HEADER"."PARTNERID" , "VORA"."SO_HEADER"."GROSSAMOUNT" , "VORA"."ORDER_COUNT"."SALESORDERID" ,"VORA"."ORDER_COUNT"."NOOFITEMS"  
    FROM  "VORA"."ORDER_COUNT"
	    INNER JOIN "VORA"."SO_HEADER" 
	    ON "VORA"."ORDER_COUNT"."SALESORDERID" = "VORA"."SO_HEADER"."SALESORDERID"
	    INNER JOIN "VORA"."BUSINESS_PARTNER" 
	    ON "VORA"."SO_HEADER"."PARTNERID" = "VORA"."BUSINESS_PARTNER"."PARTNERID"
	    INNER JOIN "VORA"."ADDRESSES" 
	    ON "VORA"."BUSINESS_PARTNER"."ADDRESSID" = "VORA"."ADDRESSES"."ADDRESSID" 
    ORDER BY "VORA"."SO_HEADER"."CREATEDAT";

    ```

