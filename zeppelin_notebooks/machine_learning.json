{"paragraphs":[{"text":"%jdbc\n//Query 1\nCREATE VIEW KMEANS_INPUT_REFERENCE_DATA AS\nSelect PARTNERID, sum(GROSSAMOUNT) as TOTAL_SALESAMOUNT, \n    sum(NOOFITEMS) as NOOFITEMS, CASE REGION WHEN 'APJ' THEN 1 WHEN 'AFR' THEN 2 WHEN 'AMER' THEN 3 WHEN 'EMEA' THEN 4 END as REGION\nfrom ORDER_DETAILS\ngroup by PARTNERID, REGION \norder by PARTNERID\nUSING com.sap.spark.view\n","dateUpdated":"2017-05-19T15:05:42+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786835_167401493","id":"20170125-090116_363425457","result":{"code":"SUCCESS","type":"TABLE","msg":"Result\n","comment":"","msgTable":[],"columnNames":[{"name":"Result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:17:46+0000","dateFinished":"2017-05-19T13:17:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4395"},{"text":"%jdbc\n//Query 2\nselect * from  KMEANS_INPUT_REFERENCE_DATA","dateUpdated":"2017-05-19T15:05:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786837_165093000","id":"20170201-061229_943515143","result":{"code":"SUCCESS","type":"TABLE","msg":"PARTNERID\tTOTAL_SALESAMOUNT\tNOOFITEMS\tREGION\n100000000\t7780730.48\t1229\t4\n100000001\t6149295.00\t1081\t4\n100000002\t6525153.12\t1241\t3\n100000003\t5183631.76\t1200\t4\n100000004\t5853452.04\t1146\t3\n100000005\t5440062.32\t1245\t4\n100000006\t6823042.64\t1302\t1\n100000007\t4757461.00\t976\t4\n100000008\t6181218.96\t1278\t3\n100000009\t6536369.08\t1111\t3\n100000010\t4269798.00\t1040\t3\n100000011\t6539915.12\t1265\t4\n100000012\t7573229.48\t1264\t4\n100000013\t7621094.64\t1347\t4\n100000014\t6289659.96\t1261\t3\n100000015\t5922788.32\t1268\t3\n100000016\t5184131.76\t1236\t3\n100000017\t5153134.04\t1127\t4\n100000018\t6719056.08\t1241\t3\n100000019\t6744174.04\t1257\t4\n100000020\t5696569.00\t1116\t4\n100000021\t7487663.96\t1298\t3\n100000022\t6898311.32\t1262\t4\n100000023\t6767793.76\t1250\t4\n100000024\t6179317.64\t1309\t1\n100000025\t6100355.12\t1195\t4\n100000026\t6120909.56\t1316\t4\n100000027\t6328819.08\t1185\t3\n100000028\t5234163.48\t1137\t3\n100000029\t6347564.00\t1061\t3\n100000030\t5904171.12\t1275\t4\n100000031\t4870238.32\t1270\t3\n100000032\t7269333.64\t1318\t4\n100000033\t6232279.96\t1248\t3\n100000034\t5524801.76\t1254\t1\n100000035\t5357738.04\t1205\t3\n100000036\t6080244.85\t1275\t2\n100000037\t6446364.10\t1200\t3\n100000038\t5713121.39\t1199\t4\n100000039\t5857553.00\t1138\t1\n100000040\t5473667.00\t1089\t4\n100000041\t6389226.77\t1211\t3\n100000042\t5544159.44\t1227\t1\n100000043\t5708671.24\t1169\t4\n100000044\t1306304.22\t369\t4\n","comment":"","msgTable":[[{"key":"TOTAL_SALESAMOUNT","value":"100000000"},{"key":"TOTAL_SALESAMOUNT","value":"7780730.48"},{"key":"TOTAL_SALESAMOUNT","value":"1229"},{"key":"TOTAL_SALESAMOUNT","value":"4"}],[{"key":"NOOFITEMS","value":"100000001"},{"key":"NOOFITEMS","value":"6149295.00"},{"key":"NOOFITEMS","value":"1081"},{"key":"NOOFITEMS","value":"4"}],[{"key":"REGION","value":"100000002"},{"key":"REGION","value":"6525153.12"},{"key":"REGION","value":"1241"},{"key":"REGION","value":"3"}],[{"value":"100000003"},{"value":"5183631.76"},{"value":"1200"},{"value":"4"}],[{"value":"100000004"},{"value":"5853452.04"},{"value":"1146"},{"value":"3"}],[{"value":"100000005"},{"value":"5440062.32"},{"value":"1245"},{"value":"4"}],[{"value":"100000006"},{"value":"6823042.64"},{"value":"1302"},{"value":"1"}],[{"value":"100000007"},{"value":"4757461.00"},{"value":"976"},{"value":"4"}],[{"value":"100000008"},{"value":"6181218.96"},{"value":"1278"},{"value":"3"}],[{"value":"100000009"},{"value":"6536369.08"},{"value":"1111"},{"value":"3"}],[{"value":"100000010"},{"value":"4269798.00"},{"value":"1040"},{"value":"3"}],[{"value":"100000011"},{"value":"6539915.12"},{"value":"1265"},{"value":"4"}],[{"value":"100000012"},{"value":"7573229.48"},{"value":"1264"},{"value":"4"}],[{"value":"100000013"},{"value":"7621094.64"},{"value":"1347"},{"value":"4"}],[{"value":"100000014"},{"value":"6289659.96"},{"value":"1261"},{"value":"3"}],[{"value":"100000015"},{"value":"5922788.32"},{"value":"1268"},{"value":"3"}],[{"value":"100000016"},{"value":"5184131.76"},{"value":"1236"},{"value":"3"}],[{"value":"100000017"},{"value":"5153134.04"},{"value":"1127"},{"value":"4"}],[{"value":"100000018"},{"value":"6719056.08"},{"value":"1241"},{"value":"3"}],[{"value":"100000019"},{"value":"6744174.04"},{"value":"1257"},{"value":"4"}],[{"value":"100000020"},{"value":"5696569.00"},{"value":"1116"},{"value":"4"}],[{"value":"100000021"},{"value":"7487663.96"},{"value":"1298"},{"value":"3"}],[{"value":"100000022"},{"value":"6898311.32"},{"value":"1262"},{"value":"4"}],[{"value":"100000023"},{"value":"6767793.76"},{"value":"1250"},{"value":"4"}],[{"value":"100000024"},{"value":"6179317.64"},{"value":"1309"},{"value":"1"}],[{"value":"100000025"},{"value":"6100355.12"},{"value":"1195"},{"value":"4"}],[{"value":"100000026"},{"value":"6120909.56"},{"value":"1316"},{"value":"4"}],[{"value":"100000027"},{"value":"6328819.08"},{"value":"1185"},{"value":"3"}],[{"value":"100000028"},{"value":"5234163.48"},{"value":"1137"},{"value":"3"}],[{"value":"100000029"},{"value":"6347564.00"},{"value":"1061"},{"value":"3"}],[{"value":"100000030"},{"value":"5904171.12"},{"value":"1275"},{"value":"4"}],[{"value":"100000031"},{"value":"4870238.32"},{"value":"1270"},{"value":"3"}],[{"value":"100000032"},{"value":"7269333.64"},{"value":"1318"},{"value":"4"}],[{"value":"100000033"},{"value":"6232279.96"},{"value":"1248"},{"value":"3"}],[{"value":"100000034"},{"value":"5524801.76"},{"value":"1254"},{"value":"1"}],[{"value":"100000035"},{"value":"5357738.04"},{"value":"1205"},{"value":"3"}],[{"value":"100000036"},{"value":"6080244.85"},{"value":"1275"},{"value":"2"}],[{"value":"100000037"},{"value":"6446364.10"},{"value":"1200"},{"value":"3"}],[{"value":"100000038"},{"value":"5713121.39"},{"value":"1199"},{"value":"4"}],[{"value":"100000039"},{"value":"5857553.00"},{"value":"1138"},{"value":"1"}],[{"value":"100000040"},{"value":"5473667.00"},{"value":"1089"},{"value":"4"}],[{"value":"100000041"},{"value":"6389226.77"},{"value":"1211"},{"value":"3"}],[{"value":"100000042"},{"value":"5544159.44"},{"value":"1227"},{"value":"1"}],[{"value":"100000043"},{"value":"5708671.24"},{"value":"1169"},{"value":"4"}],[{"value":"100000044"},{"value":"1306304.22"},{"value":"369"},{"value":"4"}]],"columnNames":[{"name":"PARTNERID","index":0,"aggr":"sum"},{"name":"TOTAL_SALESAMOUNT","index":1,"aggr":"sum"},{"name":"NOOFITEMS","index":2,"aggr":"sum"},{"name":"REGION","index":3,"aggr":"sum"}],"rows":[["100000000","7780730.48","1229","4"],["100000001","6149295.00","1081","4"],["100000002","6525153.12","1241","3"],["100000003","5183631.76","1200","4"],["100000004","5853452.04","1146","3"],["100000005","5440062.32","1245","4"],["100000006","6823042.64","1302","1"],["100000007","4757461.00","976","4"],["100000008","6181218.96","1278","3"],["100000009","6536369.08","1111","3"],["100000010","4269798.00","1040","3"],["100000011","6539915.12","1265","4"],["100000012","7573229.48","1264","4"],["100000013","7621094.64","1347","4"],["100000014","6289659.96","1261","3"],["100000015","5922788.32","1268","3"],["100000016","5184131.76","1236","3"],["100000017","5153134.04","1127","4"],["100000018","6719056.08","1241","3"],["100000019","6744174.04","1257","4"],["100000020","5696569.00","1116","4"],["100000021","7487663.96","1298","3"],["100000022","6898311.32","1262","4"],["100000023","6767793.76","1250","4"],["100000024","6179317.64","1309","1"],["100000025","6100355.12","1195","4"],["100000026","6120909.56","1316","4"],["100000027","6328819.08","1185","3"],["100000028","5234163.48","1137","3"],["100000029","6347564.00","1061","3"],["100000030","5904171.12","1275","4"],["100000031","4870238.32","1270","3"],["100000032","7269333.64","1318","4"],["100000033","6232279.96","1248","3"],["100000034","5524801.76","1254","1"],["100000035","5357738.04","1205","3"],["100000036","6080244.85","1275","2"],["100000037","6446364.10","1200","3"],["100000038","5713121.39","1199","4"],["100000039","5857553.00","1138","1"],["100000040","5473667.00","1089","4"],["100000041","6389226.77","1211","3"],["100000042","5544159.44","1227","1"],["100000043","5708671.24","1169","4"],["100000044","1306304.22","369","4"]]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:18:01+0000","dateFinished":"2017-05-19T13:22:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4396"},{"title":"K_means","text":"// Program 1\r\nimport org.apache.spark.mllib.linalg.Vectors\r\nimport org.apache.spark.mllib.clustering.KMeans\r\nimport org.apache.spark.sql.functions._\r\n\r\n//Load input data\r\nval data = sc.textFile(\"/user/vora/kmeans_input_data.csv\")\r\n\r\n//Removing the headers\r\nval header = data.first\r\nval rows = data.filter(l => l != header)\r\n\r\n//Defining the case class\r\ncase class caseClass(ID: String, TOTAL_SALESAMOUNT: Double, NOOFITEMS: Double, REGION: Int)\r\n\r\n//Split each row by comma to get the columns\r\nval rowSplit = rows.map(line => line.split(\",\"))\r\n\r\n//Mapping the data to case class\r\nval rowData = rowSplit.map( p => caseClass( p(0).toString, p(1).trim.toDouble, p(2).trim.toDouble, p(3).trim.toInt))\r\n\r\n//Creating dataframe from the rowData\r\nval df1 = rowData.toDF()\r\n\r\n//Convert to RDD with the rowId\r\nval rdd1 = df1.rdd.map(r => (r.getString(0),  r.getDouble(1), r.getDouble(2), r.getInt(3)))\r\n\r\n//Cache the RDD\r\nrdd1.cache()\r\n\r\n//Convert to RDD without rowId. This will be the input to the KMeans algorithm\r\nval vectors = df1.rdd.map(r => Vectors.dense( r.getDouble(1), r.getDouble(2), r.getInt(3)))\r\n//Cache the RDD\r\nvectors.cache()\r\n\r\n//KMeans model with 10 clusters and 30 iterations\r\nval numClusters = 10\r\nval numIterations = 30\r\nval kMeansModel = KMeans.train(vectors, numClusters, numIterations)\r\n\r\n//Print the center of each cluster\r\nkMeansModel.clusterCenters.foreach(println)\r\n\r\n//Get the clusters from the model and link it to the rowId using rdd1\r\nval cluster = rdd1.map{r => (r._1, kMeansModel.predict(Vectors.dense(r._2, r._3, r._4) ))}\r\n\r\n//Convert rdd to dataframe with rowId and cluster\r\nval clusterDF = cluster.toDF(\"ID\", \"CLUSTER\")\r\n\r\n//Create temporary table from the df and display the results \r\nclusterDF.registerTempTable(\"CLUSTER_MAPPING\")\r\nclusterDF.show()\r\n\r\n","dateUpdated":"2017-05-19T13:24:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786837_165093000","id":"20170125-105458_1574569901","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.clustering.KMeans\nimport org.apache.spark.sql.functions._\ndata: org.apache.spark.rdd.RDD[String] = /user/vora/kmeans_input_data.csv MapPartitionsRDD[1] at textFile at <console>:34\nheader: String = PARTNERID,TOTAL_SALESAMOUNT,NOOFITEMS,REGION\nrows: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[2] at filter at <console>:38\ndefined class caseClass\nrowSplit: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[3] at map at <console>:40\nrowData: org.apache.spark.rdd.RDD[caseClass] = MapPartitionsRDD[4] at map at <console>:44\ndf1: org.apache.spark.sql.DataFrame = [ID: string, TOTAL_SALESAMOUNT: double, NOOFITEMS: double, REGION: int]\nrdd1: org.apache.spark.rdd.RDD[(String, Double, Double, Int)] = MapPartitionsRDD[7] at map at <console>:48\nres1: rdd1.type = MapPartitionsRDD[7] at map at <console>:48\nvectors: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.Vector] = MapPartitionsRDD[8] at map at <console>:48\nres2: vectors.type = MapPartitionsRDD[8] at map at <console>:48\nnumClusters: Int = 10\nnumIterations: Int = 30\nkMeansModel: org.apache.spark.mllib.clustering.KMeansModel = org.apache.spark.mllib.clustering.KMeansModel@615726eb\n[6694226.895,1241.125,3.25]\n[4813849.66,1123.0,3.5]\n[1306304.22,369.0,4.0]\n[6266420.303,1214.8,3.0]\n[5706120.543333333,1161.3333333333333,4.0]\n[7546410.440000001,1291.2,3.8000000000000003]\n[5188765.26,1175.0,3.5]\n[5953094.075,1216.1666666666665,2.833333333333333]\n[5468085.712000001,1204.8,2.6]\n[4269798.0,1040.0,3.0]\ncluster: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[40] at map at <console>:58\nclusterDF: org.apache.spark.sql.DataFrame = [ID: string, CLUSTER: int]\n+---------+-------+\n|       ID|CLUSTER|\n+---------+-------+\n|100000000|      5|\n|100000001|      3|\n|100000002|      0|\n|100000003|      6|\n|100000004|      7|\n|100000005|      8|\n|100000006|      0|\n|100000007|      1|\n|100000008|      3|\n|100000009|      0|\n|100000010|      9|\n|100000011|      0|\n|100000012|      5|\n|100000013|      5|\n|100000014|      3|\n|100000015|      7|\n|100000016|      6|\n|100000017|      6|\n|100000018|      0|\n|100000019|      0|\n+---------+-------+\nonly showing top 20 rows\n\n"},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:24:47+0000","dateFinished":"2017-05-19T13:29:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4397"},{"text":"%sql\r\n--Query 3\r\nSELECT * from CLUSTER_MAPPING ","dateUpdated":"2017-05-19T13:34:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":364,"optionOpen":false,"keys":[{"name":"ID","index":0,"aggr":"sum"}],"values":[{"name":"CLUSTER","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ID","index":0,"aggr":"sum"},"yAxis":{"name":"CLUSTER","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786837_165093000","id":"20170202-064953_2108653398","result":{"code":"SUCCESS","type":"TABLE","msg":"ID\tCLUSTER\n100000019\t0\n100000002\t0\n100000009\t0\n100000011\t0\n100000022\t0\n100000006\t0\n100000023\t0\n100000018\t0\n100000007\t1\n100000031\t1\n100000044\t2\n100000026\t3\n100000008\t3\n100000024\t3\n100000029\t3\n100000001\t3\n100000027\t3\n100000033\t3\n100000037\t3\n100000041\t3\n100000014\t3\n100000038\t4\n100000043\t4\n100000020\t4\n100000032\t5\n100000013\t5\n100000000\t5\n100000012\t5\n100000021\t5\n100000017\t6\n100000003\t6\n100000016\t6\n100000028\t6\n100000039\t7\n100000030\t7\n100000004\t7\n100000036\t7\n100000025\t7\n100000015\t7\n100000005\t8\n100000035\t8\n100000042\t8\n100000034\t8\n100000040\t8\n100000010\t9\n","comment":"","msgTable":[[{"key":"CLUSTER","value":"100000019"},{"key":"CLUSTER","value":"0"}],[{"value":"100000002"},{"value":"0"}],[{"value":"100000009"},{"value":"0"}],[{"value":"100000011"},{"value":"0"}],[{"value":"100000022"},{"value":"0"}],[{"value":"100000006"},{"value":"0"}],[{"value":"100000023"},{"value":"0"}],[{"value":"100000018"},{"value":"0"}],[{"value":"100000007"},{"value":"1"}],[{"value":"100000031"},{"value":"1"}],[{"value":"100000044"},{"value":"2"}],[{"value":"100000026"},{"value":"3"}],[{"value":"100000008"},{"value":"3"}],[{"value":"100000024"},{"value":"3"}],[{"value":"100000029"},{"value":"3"}],[{"value":"100000001"},{"value":"3"}],[{"value":"100000027"},{"value":"3"}],[{"value":"100000033"},{"value":"3"}],[{"value":"100000037"},{"value":"3"}],[{"value":"100000041"},{"value":"3"}],[{"value":"100000014"},{"value":"3"}],[{"value":"100000038"},{"value":"4"}],[{"value":"100000043"},{"value":"4"}],[{"value":"100000020"},{"value":"4"}],[{"value":"100000032"},{"value":"5"}],[{"value":"100000013"},{"value":"5"}],[{"value":"100000000"},{"value":"5"}],[{"value":"100000012"},{"value":"5"}],[{"value":"100000021"},{"value":"5"}],[{"value":"100000017"},{"value":"6"}],[{"value":"100000003"},{"value":"6"}],[{"value":"100000016"},{"value":"6"}],[{"value":"100000028"},{"value":"6"}],[{"value":"100000039"},{"value":"7"}],[{"value":"100000030"},{"value":"7"}],[{"value":"100000004"},{"value":"7"}],[{"value":"100000036"},{"value":"7"}],[{"value":"100000025"},{"value":"7"}],[{"value":"100000015"},{"value":"7"}],[{"value":"100000005"},{"value":"8"}],[{"value":"100000035"},{"value":"8"}],[{"value":"100000042"},{"value":"8"}],[{"value":"100000034"},{"value":"8"}],[{"value":"100000040"},{"value":"8"}],[{"value":"100000010"},{"value":"9"}]],"columnNames":[{"name":"ID","index":0,"aggr":"sum"},{"name":"CLUSTER","index":1,"aggr":"sum"}],"rows":[["100000019","0"],["100000002","0"],["100000009","0"],["100000011","0"],["100000022","0"],["100000006","0"],["100000023","0"],["100000018","0"],["100000007","1"],["100000031","1"],["100000044","2"],["100000026","3"],["100000008","3"],["100000024","3"],["100000029","3"],["100000001","3"],["100000027","3"],["100000033","3"],["100000037","3"],["100000041","3"],["100000014","3"],["100000038","4"],["100000043","4"],["100000020","4"],["100000032","5"],["100000013","5"],["100000000","5"],["100000012","5"],["100000021","5"],["100000017","6"],["100000003","6"],["100000016","6"],["100000028","6"],["100000039","7"],["100000030","7"],["100000004","7"],["100000036","7"],["100000025","7"],["100000015","7"],["100000005","8"],["100000035","8"],["100000042","8"],["100000034","8"],["100000040","8"],["100000010","9"]]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:34:43+0000","dateFinished":"2017-05-19T13:34:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4398"},{"title":"FP_Growth","text":"// Program 2\r\nimport org.apache.spark.sql.SQLContext\r\nimport org.apache.spark.rdd.RDD\r\nimport org.apache.spark.mllib.fpm.FPGrowth\r\nimport org.apache.spark.sql.hive.HiveContext\r\nimport org.apache.spark.sql.SQLContext\r\nimport org.apache.spark.sql.functions.collect_list\r\nimport org.apache.spark.sql.Row\r\n\r\n//Loading data\r\nvar soItem = sqlContext.read.load(\"/user/vora/soItemData.parquet\");\r\nval texts = sqlContext.read.load(\"/user/vora/texts.parquet\")\r\nval products  = sqlContext.read.load(\"/user/vora/products.parquet\")\r\n\r\n// Grouping product based on salesOrder\r\nsoItem.registerTempTable(\"SO_ITEM\");\r\nvar soItemView = sqlContext.sql(\"SELECT SALESORDERID, PRODUCTID from SO_ITEM\")\r\nsoItemView.registerTempTable(\"SO_ITEM_VIEW\");\r\nvar groupedData = sqlContext.sql(\"SELECT SALESORDERID, collect_set(PRODUCTID) as itemList from SO_ITEM_VIEW group by SALESORDERID\")\r\ngroupedData.registerTempTable(\"GRP_BY_SOID\")\r\nvar itemsPerTransaction = sqlContext.sql(\"SELECT itemList from GRP_BY_SOID\")\r\n\r\n// Converting List[String] to String\r\nval mkString = udf((items:Seq[String])=>items.mkString(\",\"))\r\nval dataframeWithString = itemsPerTransaction.select($\"itemList\").withColumn(\"arrayString\",mkString($\"itemList\"))\r\nvar dfwsNew = dataframeWithString.drop(dataframeWithString.col(\"itemList\"))\r\nvar fpgInputData =  dfwsNew.rdd.map{x:Row => x.getAs[String](0)}\r\n\r\n// Running FPGrowth Algorithm\r\nval data: RDD[Array[String]] = fpgInputData.map(s => s.trim.split(','))\r\nval fpGrowth = new FPGrowth().setMinSupport(0.005).setNumPartitions(10)\r\nval fpGrowthModel = fpGrowth.run(data)\r\n\r\nvar freqItemset = (fpGrowthModel.freqItemsets.map{itemset => (itemset.items,  itemset.freq)})\r\nvar freqItemsetDF = freqItemset.toDF(\"frequentItems\",\"frequency\")\r\nval freqItemCollection = freqItemsetDF.filter(size('frequentItems) > 1)\r\n\r\n\r\n// replacing ProductID with product description\r\nval freqItems = freqItemsetDF.filter(size('frequentItems) === 1).select('frequentItems(0).as('item), 'frequency)\r\ntexts.registerTempTable(\"TEXT\")\r\nproducts.registerTempTable(\"PRODUCTS\")\r\nval productDict = sqlContext.sql(\"SELECT PRODUCTID, SHORT_TEXT from PRODUCTS join TEXT where NAMEID == TEXTID\")\r\nval freqDict = freqItems.join(productDict, 'item === 'PRODUCTID, \"left\").select('item, 'SHORT_TEXT).as[(String, String)].collect().toMap\r\n\r\nval pidToDescMapping = udf { items: Seq[String] => items.map(item => freqDict(item)) }\r\nval freqItemDescs = freqItemCollection.select('frequency, pidToDescMapping('frequentItems).as('itemDescs))\r\nval freqItemDescsString = freqItemDescs.select($\"frequency\",$\"itemDescs\").withColumn(\"ItemSet\",mkString($\"itemDescs\"))\r\nval frequentItemDesc = freqItemDescsString.select($\"ItemSet\",$\"frequency\")\r\n\r\n// Normalising the frequency\r\nval min = frequentItemDesc.groupBy().min().head().getLong(0)\r\nval max = frequentItemDesc.groupBy().max().head().getLong(0)\r\nval minInDouble = min.toDouble\r\nval maxInDouble = max.toDouble\r\nval normaliseUDF: (Long => Double) = (arg: Long) => {(arg - minInDouble)/(maxInDouble - minInDouble)}\r\nval normalisedFreq = udf(normaliseUDF)\r\nval frequentItems = frequentItemDesc.withColumn(\"normalised_frequency\", round(normalisedFreq(col(\"frequency\")),2))\r\nfrequentItems.registerTempTable(\"FREQUENT_ITEMS\")\r\n\r\n// Generating rules for frequent Items\r\nval minConfidence = 0.8\r\n\r\nvar rules = (fpGrowthModel.generateAssociationRules(minConfidence).map{ rule => (rule.antecedent.map(item => freqDict(item)).mkString(\",\"), rule.consequent.map(item => freqDict(item)).mkString(\",\"))})\r\nvar rulesDF = rules.toDF(\"antecedent\",\"consequent\")\r\nrulesDF.registerTempTable(\"RULES\")","dateUpdated":"2017-05-19T13:43:03+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786838_166247247","id":"20170202-083014_1720314193","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.SQLContext\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.mllib.fpm.FPGrowth\nimport org.apache.spark.sql.hive.HiveContext\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.sql.functions.collect_list\nimport org.apache.spark.sql.Row\nsoItem: org.apache.spark.sql.DataFrame = [SALESORDERID: string, SALESORDERITEM: string, PRODUCTID: string, NOTEID: string, CURRENCY: string, GROSSAMOUNT: decimal(15,2), NETAMOUNT: decimal(15,2), TAXAMOUNT: decimal(15,2), ITEMATPSTATUS: string, OPITEMPOS: string, QUANTITY: decimal(15,2), QUANTITYUNIT: string, DELIVERYDATE: date]\ntexts: org.apache.spark.sql.DataFrame = [TEXTID: string, LANGUAGE: string, ISOLANGUAGE: string, TEXT: string, SHORT_TEXT: string]\nproducts: org.apache.spark.sql.DataFrame = [PRODUCTID: string, TYPECODE: string, CATEGORY: string, CREATEDBY_EMPLOYEEID: string, CREATEDAT: date, CHANGEDBY_EMPLOYEEID: string, CHANGEDAT: date, NAMEID: string, DESCID: string, PARTNERID: string, TAXTARIFFCODE: int, QUANTITYUNIT: string, WEIGHTMEASURE: decimal(13,3), WEIGHTUNIT: string, CURRENCY: string, PRICE: decimal(15,2), PRODUCTPICURL: string, WIDTH: decimal(13,3), DEPTH: decimal(13,3), HEIGHT: decimal(13,3), DIMENSIONUNIT: string]\nsoItemView: org.apache.spark.sql.DataFrame = [SALESORDERID: string, PRODUCTID: string]\ngroupedData: org.apache.spark.sql.DataFrame = [SALESORDERID: string, itemList: array<string>]\nitemsPerTransaction: org.apache.spark.sql.DataFrame = [itemList: array<string>]\nmkString: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(ArrayType(StringType,true)))\ndataframeWithString: org.apache.spark.sql.DataFrame = [itemList: array<string>, arrayString: string]\ndfwsNew: org.apache.spark.sql.DataFrame = [arrayString: string]\nfpgInputData: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[70] at map at <console>:48\ndata: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[71] at map at <console>:50\nfpGrowth: org.apache.spark.mllib.fpm.FPGrowth = org.apache.spark.mllib.fpm.FPGrowth@67665760\nfpGrowthModel: org.apache.spark.mllib.fpm.FPGrowthModel[String] = org.apache.spark.mllib.fpm.FPGrowthModel@62c54908\nfreqItemset: org.apache.spark.rdd.RDD[(Array[String], Long)] = MapPartitionsRDD[80] at map at <console>:56\nfreqItemsetDF: org.apache.spark.sql.DataFrame = [frequentItems: array<string>, frequency: bigint]\nfreqItemCollection: org.apache.spark.sql.DataFrame = [frequentItems: array<string>, frequency: bigint]\nfreqItems: org.apache.spark.sql.DataFrame = [item: string, frequency: bigint]\nproductDict: org.apache.spark.sql.DataFrame = [PRODUCTID: string, SHORT_TEXT: string]\nfreqDict: scala.collection.immutable.Map[String,String] = Map(HT-1083 -> Jet Scan Pro, HT-1056 -> Inkjet Multi Color, HT-1023 -> Smartphone P2, HT-2026 -> AV Cable Kit, HT-6102 -> Beam Breaker B-3, HT-1105 -> Smart Internet AV, HT-1116 -> ISDN Direct, HT-1067 -> Ergo Mousepad, HT-1001 -> Notebook 17\"\", HT-1119 -> USB Stick 16, HT-8002 -> Notebook I9100, HT-1091 -> \"Speaker Blaster \", HT-1066 -> Mousepad, HT-1051 -> Inkjet Mobile, HT-1011 -> Note  17\"\", HT-6121 -> Basic Booster B, HT-1501 -> Server Pro, HT-1073 -> Graphic card HGX, HT-1110 -> PC Lock, HT-6110 -> DVD Player, HT-1101 -> Smart Design S/w, HT-1055 -> Inkjet ALLINONE, HT-1022 -> Smartphone 7, HT-2027 -> PC DVD Drive, HT-1062 -> Track Mouse, HT-6132 -> HD TV 41\"\", HT-1104 -> Smart Games, HT-1040 -> Laser STAR, HT-1000 -> Noteb...pidToDescMapping: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,ArrayType(StringType,true),List(ArrayType(StringType,true)))\nfreqItemDescs: org.apache.spark.sql.DataFrame = [frequency: bigint, itemDescs: array<string>]\nfreqItemDescsString: org.apache.spark.sql.DataFrame = [frequency: bigint, itemDescs: array<string>, ItemSet: string]\nfrequentItemDesc: org.apache.spark.sql.DataFrame = [ItemSet: string, frequency: bigint]\nmin: Long = 101\nmax: Long = 170\nminInDouble: Double = 101.0\nmaxInDouble: Double = 170.0\nnormaliseUDF: Long => Double = <function1>\nnormalisedFreq: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,List(LongType))\nfrequentItems: org.apache.spark.sql.DataFrame = [ItemSet: string, frequency: bigint, normalised_frequency: double]\nminConfidence: Double = 0.8\nrules: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[121] at map at <console>:68\nrulesDF: org.apache.spark.sql.DataFrame = [antecedent: string, consequent: string]\n"},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:43:04+0000","dateFinished":"2017-05-19T13:45:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4399"},{"text":"%sql\n--Query 4\nselect * from FREQUENT_ITEMS","dateUpdated":"2017-05-19T13:47:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786838_166247247","id":"20170207-083809_1167440473","result":{"code":"SUCCESS","type":"TABLE","msg":"ItemSet\tfrequency\tnormalised_frequency\nPC Future,\"PC 19\"\"B\"\t134\t0.48\nPC Future,PC  17\"\"\t111\t0.14\nPC Future,PC 19\"\"\t127\t0.38\nPC Future,PC 19\"\",\"PC 19\"\"B\"\t120\t0.28\nPC Future,PC 19\"\",PC  17\"\"\t101\t0.0\nPC Future,PC 19\"\",PC  21\"\"\t120\t0.28\nPC Future,PC 19\"\",PC  21\"\",\"PC 19\"\"B\"\t120\t0.28\nPC Future,PC  21\"\"\t126\t0.36\nPC Future,PC  21\"\",\"PC 19\"\"B\"\t120\t0.28\nSmart START S/w,Smart Nw Software\t129\t0.41\nSmart Firewall-B,Smart Internet AV\t128\t0.39\nSmart Firewall-B,Smart Internet AV,Smart Money s/w\t120\t0.28\nSmart Firewall-B,Smart Money s/w\t129\t0.41\nWeb cam ,PC Lock\t108\t0.1\nWeb cam ,Notebook Lock\t114\t0.19\nPC 19\"\",\"PC 19\"\"B\"\t132\t0.45\nPC 19\"\",PC  17\"\"\t153\t0.75\nPC 19\"\",PC  17\"\",\"PC 19\"\"B\"\t101\t0.0\nPC 19\"\",PC  17\"\",PC  21\"\"\t140\t0.57\nPC 19\"\",PC  21\"\"\t170\t1.0\nPC 19\"\",PC  21\"\",\"PC 19\"\"B\"\t120\t0.28\nSmart Internet AV,Smart Money s/w\t124\t0.33\nPrinter Basic,Laser STAR\t144\t0.62\nSmart Design S/w,Smart Nw Software\t111\t0.14\nNotebook 19\"\",Notebook 17\"\"\t124\t0.33\nNotebook 19\"\",Notebook 15\"\"\t121\t0.29\nNotebook 19\"\",Notebook 15\"\",Notebook 17\"\"\t110\t0.13\nInternet Keyboard,Media Keyboard\t107\t0.09\nNotebook 18\"\",Notebook 17\"\"\t123\t0.32\nNotebook 18\"\",Notebook 19\"\"\t124\t0.33\nNotebook 18\"\",Notebook 19\"\",Notebook 17\"\"\t113\t0.17\nNotebook 18\"\",Notebook 19\"\",Notebook 15\"\"\t110\t0.13\nNotebook 18\"\",Notebook 19\"\",Notebook 15\"\",Notebook 17\"\"\t110\t0.13\nNotebook 18\"\",Notebook 15\"\"\t117\t0.23\nNotebook 18\"\",Notebook 15\"\",Notebook 17\"\"\t110\t0.13\nPC  21\"\",\"PC 19\"\"B\"\t126\t0.36\nPC Lock,Notebook Lock\t113\t0.17\nPC  17\"\",\"PC 19\"\"B\"\t116\t0.22\nPC  17\"\",PC  21\"\"\t146\t0.65\nPC  17\"\",PC  21\"\",\"PC 19\"\"B\"\t102\t0.01\nSmart Office S/w,Smart Nw Software\t108\t0.1\nSmart Office S/w,Smart Design S/w\t104\t0.04\nPrinter AllRound,Printer Basic\t145\t0.64\nPrinter AllRound,Printer Basic,Laser STAR\t136\t0.51\nPrinter AllRound,Laser STAR\t147\t0.67\nErgonomic Keyboard,Internet Keyboard\t103\t0.03\nErgonomic Keyboard,Media Keyboard\t106\t0.07\nNotebook 15\"\",Notebook 17\"\"\t157\t0.81\n","comment":"","msgTable":[[{"key":"frequency","value":"PC Future,\"PC 19\"\"B\""},{"key":"frequency","value":"134"},{"key":"frequency","value":"0.48"}],[{"key":"normalised_frequency","value":"PC Future,PC  17\"\""},{"key":"normalised_frequency","value":"111"},{"key":"normalised_frequency","value":"0.14"}],[{"value":"PC Future,PC 19\"\""},{"value":"127"},{"value":"0.38"}],[{"value":"PC Future,PC 19\"\",\"PC 19\"\"B\""},{"value":"120"},{"value":"0.28"}],[{"value":"PC Future,PC 19\"\",PC  17\"\""},{"value":"101"},{"value":"0.0"}],[{"value":"PC Future,PC 19\"\",PC  21\"\""},{"value":"120"},{"value":"0.28"}],[{"value":"PC Future,PC 19\"\",PC  21\"\",\"PC 19\"\"B\""},{"value":"120"},{"value":"0.28"}],[{"value":"PC Future,PC  21\"\""},{"value":"126"},{"value":"0.36"}],[{"value":"PC Future,PC  21\"\",\"PC 19\"\"B\""},{"value":"120"},{"value":"0.28"}],[{"value":"Smart START S/w,Smart Nw Software"},{"value":"129"},{"value":"0.41"}],[{"value":"Smart Firewall-B,Smart Internet AV"},{"value":"128"},{"value":"0.39"}],[{"value":"Smart Firewall-B,Smart Internet AV,Smart Money s/w"},{"value":"120"},{"value":"0.28"}],[{"value":"Smart Firewall-B,Smart Money s/w"},{"value":"129"},{"value":"0.41"}],[{"value":"Web cam ,PC Lock"},{"value":"108"},{"value":"0.1"}],[{"value":"Web cam ,Notebook Lock"},{"value":"114"},{"value":"0.19"}],[{"value":"PC 19\"\",\"PC 19\"\"B\""},{"value":"132"},{"value":"0.45"}],[{"value":"PC 19\"\",PC  17\"\""},{"value":"153"},{"value":"0.75"}],[{"value":"PC 19\"\",PC  17\"\",\"PC 19\"\"B\""},{"value":"101"},{"value":"0.0"}],[{"value":"PC 19\"\",PC  17\"\",PC  21\"\""},{"value":"140"},{"value":"0.57"}],[{"value":"PC 19\"\",PC  21\"\""},{"value":"170"},{"value":"1.0"}],[{"value":"PC 19\"\",PC  21\"\",\"PC 19\"\"B\""},{"value":"120"},{"value":"0.28"}],[{"value":"Smart Internet AV,Smart Money s/w"},{"value":"124"},{"value":"0.33"}],[{"value":"Printer Basic,Laser STAR"},{"value":"144"},{"value":"0.62"}],[{"value":"Smart Design S/w,Smart Nw Software"},{"value":"111"},{"value":"0.14"}],[{"value":"Notebook 19\"\",Notebook 17\"\""},{"value":"124"},{"value":"0.33"}],[{"value":"Notebook 19\"\",Notebook 15\"\""},{"value":"121"},{"value":"0.29"}],[{"value":"Notebook 19\"\",Notebook 15\"\",Notebook 17\"\""},{"value":"110"},{"value":"0.13"}],[{"value":"Internet Keyboard,Media Keyboard"},{"value":"107"},{"value":"0.09"}],[{"value":"Notebook 18\"\",Notebook 17\"\""},{"value":"123"},{"value":"0.32"}],[{"value":"Notebook 18\"\",Notebook 19\"\""},{"value":"124"},{"value":"0.33"}],[{"value":"Notebook 18\"\",Notebook 19\"\",Notebook 17\"\""},{"value":"113"},{"value":"0.17"}],[{"value":"Notebook 18\"\",Notebook 19\"\",Notebook 15\"\""},{"value":"110"},{"value":"0.13"}],[{"value":"Notebook 18\"\",Notebook 19\"\",Notebook 15\"\",Notebook 17\"\""},{"value":"110"},{"value":"0.13"}],[{"value":"Notebook 18\"\",Notebook 15\"\""},{"value":"117"},{"value":"0.23"}],[{"value":"Notebook 18\"\",Notebook 15\"\",Notebook 17\"\""},{"value":"110"},{"value":"0.13"}],[{"value":"PC  21\"\",\"PC 19\"\"B\""},{"value":"126"},{"value":"0.36"}],[{"value":"PC Lock,Notebook Lock"},{"value":"113"},{"value":"0.17"}],[{"value":"PC  17\"\",\"PC 19\"\"B\""},{"value":"116"},{"value":"0.22"}],[{"value":"PC  17\"\",PC  21\"\""},{"value":"146"},{"value":"0.65"}],[{"value":"PC  17\"\",PC  21\"\",\"PC 19\"\"B\""},{"value":"102"},{"value":"0.01"}],[{"value":"Smart Office S/w,Smart Nw Software"},{"value":"108"},{"value":"0.1"}],[{"value":"Smart Office S/w,Smart Design S/w"},{"value":"104"},{"value":"0.04"}],[{"value":"Printer AllRound,Printer Basic"},{"value":"145"},{"value":"0.64"}],[{"value":"Printer AllRound,Printer Basic,Laser STAR"},{"value":"136"},{"value":"0.51"}],[{"value":"Printer AllRound,Laser STAR"},{"value":"147"},{"value":"0.67"}],[{"value":"Ergonomic Keyboard,Internet Keyboard"},{"value":"103"},{"value":"0.03"}],[{"value":"Ergonomic Keyboard,Media Keyboard"},{"value":"106"},{"value":"0.07"}],[{"value":"Notebook 15\"\",Notebook 17\"\""},{"value":"157"},{"value":"0.81"}]],"columnNames":[{"name":"ItemSet","index":0,"aggr":"sum"},{"name":"frequency","index":1,"aggr":"sum"},{"name":"normalised_frequency","index":2,"aggr":"sum"}],"rows":[["PC Future,\"PC 19\"\"B\"","134","0.48"],["PC Future,PC  17\"\"","111","0.14"],["PC Future,PC 19\"\"","127","0.38"],["PC Future,PC 19\"\",\"PC 19\"\"B\"","120","0.28"],["PC Future,PC 19\"\",PC  17\"\"","101","0.0"],["PC Future,PC 19\"\",PC  21\"\"","120","0.28"],["PC Future,PC 19\"\",PC  21\"\",\"PC 19\"\"B\"","120","0.28"],["PC Future,PC  21\"\"","126","0.36"],["PC Future,PC  21\"\",\"PC 19\"\"B\"","120","0.28"],["Smart START S/w,Smart Nw Software","129","0.41"],["Smart Firewall-B,Smart Internet AV","128","0.39"],["Smart Firewall-B,Smart Internet AV,Smart Money s/w","120","0.28"],["Smart Firewall-B,Smart Money s/w","129","0.41"],["Web cam ,PC Lock","108","0.1"],["Web cam ,Notebook Lock","114","0.19"],["PC 19\"\",\"PC 19\"\"B\"","132","0.45"],["PC 19\"\",PC  17\"\"","153","0.75"],["PC 19\"\",PC  17\"\",\"PC 19\"\"B\"","101","0.0"],["PC 19\"\",PC  17\"\",PC  21\"\"","140","0.57"],["PC 19\"\",PC  21\"\"","170","1.0"],["PC 19\"\",PC  21\"\",\"PC 19\"\"B\"","120","0.28"],["Smart Internet AV,Smart Money s/w","124","0.33"],["Printer Basic,Laser STAR","144","0.62"],["Smart Design S/w,Smart Nw Software","111","0.14"],["Notebook 19\"\",Notebook 17\"\"","124","0.33"],["Notebook 19\"\",Notebook 15\"\"","121","0.29"],["Notebook 19\"\",Notebook 15\"\",Notebook 17\"\"","110","0.13"],["Internet Keyboard,Media Keyboard","107","0.09"],["Notebook 18\"\",Notebook 17\"\"","123","0.32"],["Notebook 18\"\",Notebook 19\"\"","124","0.33"],["Notebook 18\"\",Notebook 19\"\",Notebook 17\"\"","113","0.17"],["Notebook 18\"\",Notebook 19\"\",Notebook 15\"\"","110","0.13"],["Notebook 18\"\",Notebook 19\"\",Notebook 15\"\",Notebook 17\"\"","110","0.13"],["Notebook 18\"\",Notebook 15\"\"","117","0.23"],["Notebook 18\"\",Notebook 15\"\",Notebook 17\"\"","110","0.13"],["PC  21\"\",\"PC 19\"\"B\"","126","0.36"],["PC Lock,Notebook Lock","113","0.17"],["PC  17\"\",\"PC 19\"\"B\"","116","0.22"],["PC  17\"\",PC  21\"\"","146","0.65"],["PC  17\"\",PC  21\"\",\"PC 19\"\"B\"","102","0.01"],["Smart Office S/w,Smart Nw Software","108","0.1"],["Smart Office S/w,Smart Design S/w","104","0.04"],["Printer AllRound,Printer Basic","145","0.64"],["Printer AllRound,Printer Basic,Laser STAR","136","0.51"],["Printer AllRound,Laser STAR","147","0.67"],["Ergonomic Keyboard,Internet Keyboard","103","0.03"],["Ergonomic Keyboard,Media Keyboard","106","0.07"],["Notebook 15\"\",Notebook 17\"\"","157","0.81"]]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:47:43+0000","dateFinished":"2017-05-19T13:47:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4400"},{"text":"%sql\n--Query 5\nselect * from RULES","dateUpdated":"2017-05-19T13:50:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786839_165862498","id":"20170207-083805_1082056629","result":{"code":"SUCCESS","type":"TABLE","msg":"antecedent\tconsequent\nPC 19\"\",\"PC 19\"\"B\"\tPC Future\nPC 19\"\",\"PC 19\"\"B\"\tPC  21\"\"\nPC 19\"\",PC  21\"\",\"PC 19\"\"B\"\tPC Future\nPrinter Basic,Laser STAR\tPrinter AllRound\nPC 19\"\",PC  17\"\"\tPC  21\"\"\nPC Future,PC  21\"\",\"PC 19\"\"B\"\tPC 19\"\"\nPC Future,\"PC 19\"\"B\"\tPC 19\"\"\nPC Future,\"PC 19\"\"B\"\tPC  21\"\"\nNotebook 18\"\",Notebook 19\"\"\tNotebook 17\"\"\nNotebook 18\"\",Notebook 19\"\"\tNotebook 15\"\"\nPC Future,PC 19\"\",\"PC 19\"\"B\"\tPC  21\"\"\nNotebook 19\"\",Notebook 15\"\"\tNotebook 17\"\"\nNotebook 19\"\",Notebook 15\"\"\tNotebook 18\"\"\nNotebook 18\"\",Notebook 19\"\",Notebook 17\"\"\tNotebook 15\"\"\nPC  17\"\",\"PC 19\"\"B\"\tPC 19\"\"\nPC  17\"\",\"PC 19\"\"B\"\tPC  21\"\"\nPrinter AllRound,Printer Basic\tLaser STAR\nNotebook 18\"\",Notebook 15\"\"\tNotebook 19\"\"\nNotebook 18\"\",Notebook 15\"\"\tNotebook 17\"\"\nNotebook 18\"\",Notebook 15\"\",Notebook 17\"\"\tNotebook 19\"\"\nPC Future,PC  21\"\"\tPC 19\"\"\nPC Future,PC  21\"\"\t\"PC 19\"\"B\"\nPC 19\"\",PC  21\"\"\tPC  17\"\"\nPrinter AllRound,Laser STAR\tPrinter Basic\nPC  17\"\",PC  21\"\"\tPC 19\"\"\nPC Future,PC  17\"\"\tPC 19\"\"\nNotebook 19\"\",Notebook 15\"\",Notebook 17\"\"\tNotebook 18\"\"\nSmart Firewall-B,Smart Money s/w\tSmart Internet AV\nPC  21\"\",\"PC 19\"\"B\"\tPC Future\nPC  21\"\",\"PC 19\"\"B\"\tPC 19\"\"\nPC  21\"\",\"PC 19\"\"B\"\tPC  17\"\"\nSmart Firewall-B,Smart Internet AV\tSmart Money s/w\nNotebook 18\"\",Notebook 19\"\",Notebook 15\"\"\tNotebook 17\"\"\nNotebook 18\"\",Notebook 17\"\"\tNotebook 19\"\"\nNotebook 18\"\",Notebook 17\"\"\tNotebook 15\"\"\nPC Future,PC 19\"\",PC  21\"\"\t\"PC 19\"\"B\"\nNotebook 19\"\",Notebook 17\"\"\tNotebook 15\"\"\nNotebook 19\"\",Notebook 17\"\"\tNotebook 18\"\"\nSmart Internet AV,Smart Money s/w\tSmart Firewall-B\nPC Future,PC 19\"\"\t\"PC 19\"\"B\"\nPC Future,PC 19\"\"\tPC  21\"\"\n","comment":"","msgTable":[[{"key":"consequent","value":"PC 19\"\",\"PC 19\"\"B\""},{"key":"consequent","value":"PC Future"}],[{"value":"PC 19\"\",\"PC 19\"\"B\""},{"value":"PC  21\"\""}],[{"value":"PC 19\"\",PC  21\"\",\"PC 19\"\"B\""},{"value":"PC Future"}],[{"value":"Printer Basic,Laser STAR"},{"value":"Printer AllRound"}],[{"value":"PC 19\"\",PC  17\"\""},{"value":"PC  21\"\""}],[{"value":"PC Future,PC  21\"\",\"PC 19\"\"B\""},{"value":"PC 19\"\""}],[{"value":"PC Future,\"PC 19\"\"B\""},{"value":"PC 19\"\""}],[{"value":"PC Future,\"PC 19\"\"B\""},{"value":"PC  21\"\""}],[{"value":"Notebook 18\"\",Notebook 19\"\""},{"value":"Notebook 17\"\""}],[{"value":"Notebook 18\"\",Notebook 19\"\""},{"value":"Notebook 15\"\""}],[{"value":"PC Future,PC 19\"\",\"PC 19\"\"B\""},{"value":"PC  21\"\""}],[{"value":"Notebook 19\"\",Notebook 15\"\""},{"value":"Notebook 17\"\""}],[{"value":"Notebook 19\"\",Notebook 15\"\""},{"value":"Notebook 18\"\""}],[{"value":"Notebook 18\"\",Notebook 19\"\",Notebook 17\"\""},{"value":"Notebook 15\"\""}],[{"value":"PC  17\"\",\"PC 19\"\"B\""},{"value":"PC 19\"\""}],[{"value":"PC  17\"\",\"PC 19\"\"B\""},{"value":"PC  21\"\""}],[{"value":"Printer AllRound,Printer Basic"},{"value":"Laser STAR"}],[{"value":"Notebook 18\"\",Notebook 15\"\""},{"value":"Notebook 19\"\""}],[{"value":"Notebook 18\"\",Notebook 15\"\""},{"value":"Notebook 17\"\""}],[{"value":"Notebook 18\"\",Notebook 15\"\",Notebook 17\"\""},{"value":"Notebook 19\"\""}],[{"value":"PC Future,PC  21\"\""},{"value":"PC 19\"\""}],[{"value":"PC Future,PC  21\"\""},{"value":"\"PC 19\"\"B\""}],[{"value":"PC 19\"\",PC  21\"\""},{"value":"PC  17\"\""}],[{"value":"Printer AllRound,Laser STAR"},{"value":"Printer Basic"}],[{"value":"PC  17\"\",PC  21\"\""},{"value":"PC 19\"\""}],[{"value":"PC Future,PC  17\"\""},{"value":"PC 19\"\""}],[{"value":"Notebook 19\"\",Notebook 15\"\",Notebook 17\"\""},{"value":"Notebook 18\"\""}],[{"value":"Smart Firewall-B,Smart Money s/w"},{"value":"Smart Internet AV"}],[{"value":"PC  21\"\",\"PC 19\"\"B\""},{"value":"PC Future"}],[{"value":"PC  21\"\",\"PC 19\"\"B\""},{"value":"PC 19\"\""}],[{"value":"PC  21\"\",\"PC 19\"\"B\""},{"value":"PC  17\"\""}],[{"value":"Smart Firewall-B,Smart Internet AV"},{"value":"Smart Money s/w"}],[{"value":"Notebook 18\"\",Notebook 19\"\",Notebook 15\"\""},{"value":"Notebook 17\"\""}],[{"value":"Notebook 18\"\",Notebook 17\"\""},{"value":"Notebook 19\"\""}],[{"value":"Notebook 18\"\",Notebook 17\"\""},{"value":"Notebook 15\"\""}],[{"value":"PC Future,PC 19\"\",PC  21\"\""},{"value":"\"PC 19\"\"B\""}],[{"value":"Notebook 19\"\",Notebook 17\"\""},{"value":"Notebook 15\"\""}],[{"value":"Notebook 19\"\",Notebook 17\"\""},{"value":"Notebook 18\"\""}],[{"value":"Smart Internet AV,Smart Money s/w"},{"value":"Smart Firewall-B"}],[{"value":"PC Future,PC 19\"\""},{"value":"\"PC 19\"\"B\""}],[{"value":"PC Future,PC 19\"\""},{"value":"PC  21\"\""}]],"columnNames":[{"name":"antecedent","index":0,"aggr":"sum"},{"name":"consequent","index":1,"aggr":"sum"}],"rows":[["PC 19\"\",\"PC 19\"\"B\"","PC Future"],["PC 19\"\",\"PC 19\"\"B\"","PC  21\"\""],["PC 19\"\",PC  21\"\",\"PC 19\"\"B\"","PC Future"],["Printer Basic,Laser STAR","Printer AllRound"],["PC 19\"\",PC  17\"\"","PC  21\"\""],["PC Future,PC  21\"\",\"PC 19\"\"B\"","PC 19\"\""],["PC Future,\"PC 19\"\"B\"","PC 19\"\""],["PC Future,\"PC 19\"\"B\"","PC  21\"\""],["Notebook 18\"\",Notebook 19\"\"","Notebook 17\"\""],["Notebook 18\"\",Notebook 19\"\"","Notebook 15\"\""],["PC Future,PC 19\"\",\"PC 19\"\"B\"","PC  21\"\""],["Notebook 19\"\",Notebook 15\"\"","Notebook 17\"\""],["Notebook 19\"\",Notebook 15\"\"","Notebook 18\"\""],["Notebook 18\"\",Notebook 19\"\",Notebook 17\"\"","Notebook 15\"\""],["PC  17\"\",\"PC 19\"\"B\"","PC 19\"\""],["PC  17\"\",\"PC 19\"\"B\"","PC  21\"\""],["Printer AllRound,Printer Basic","Laser STAR"],["Notebook 18\"\",Notebook 15\"\"","Notebook 19\"\""],["Notebook 18\"\",Notebook 15\"\"","Notebook 17\"\""],["Notebook 18\"\",Notebook 15\"\",Notebook 17\"\"","Notebook 19\"\""],["PC Future,PC  21\"\"","PC 19\"\""],["PC Future,PC  21\"\"","\"PC 19\"\"B\""],["PC 19\"\",PC  21\"\"","PC  17\"\""],["Printer AllRound,Laser STAR","Printer Basic"],["PC  17\"\",PC  21\"\"","PC 19\"\""],["PC Future,PC  17\"\"","PC 19\"\""],["Notebook 19\"\",Notebook 15\"\",Notebook 17\"\"","Notebook 18\"\""],["Smart Firewall-B,Smart Money s/w","Smart Internet AV"],["PC  21\"\",\"PC 19\"\"B\"","PC Future"],["PC  21\"\",\"PC 19\"\"B\"","PC 19\"\""],["PC  21\"\",\"PC 19\"\"B\"","PC  17\"\""],["Smart Firewall-B,Smart Internet AV","Smart Money s/w"],["Notebook 18\"\",Notebook 19\"\",Notebook 15\"\"","Notebook 17\"\""],["Notebook 18\"\",Notebook 17\"\"","Notebook 19\"\""],["Notebook 18\"\",Notebook 17\"\"","Notebook 15\"\""],["PC Future,PC 19\"\",PC  21\"\"","\"PC 19\"\"B\""],["Notebook 19\"\",Notebook 17\"\"","Notebook 15\"\""],["Notebook 19\"\",Notebook 17\"\"","Notebook 18\"\""],["Smart Internet AV,Smart Money s/w","Smart Firewall-B"],["PC Future,PC 19\"\"","\"PC 19\"\"B\""],["PC Future,PC 19\"\"","PC  21\"\""]]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:50:07+0000","dateFinished":"2017-05-19T13:50:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4401"},{"text":"%sql\n--Query 6\nselect consequent from RULES where antecedent = \"Printer AllRound,Laser STAR\"","dateUpdated":"2017-05-19T13:53:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495199786839_165862498","id":"20170207-083946_834784522","result":{"code":"SUCCESS","type":"TABLE","msg":"consequent\nPrinter Basic\n","comment":"","msgTable":[[{"value":"Printer Basic"}]],"columnNames":[{"name":"consequent","index":0,"aggr":"sum"}],"rows":[["Printer Basic"]]},"dateCreated":"2017-05-19T13:16:26+0000","dateStarted":"2017-05-19T13:53:20+0000","dateFinished":"2017-05-19T13:53:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4402"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1495202000381_-525374221","id":"20170519-135320_1576103671","dateCreated":"2017-05-19T13:53:20+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4403"}],"name":"machine_learning","id":"2CKGQ8MP4","angularObjects":{"2C52GS8A3:shared_process":[],"2C4FXH581:shared_process":[],"2C3BQZESA:shared_process":[],"2C32QQF4F:shared_process":[],"2C2YZPTBQ:shared_process":[],"2C5ZQ58W7:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}
